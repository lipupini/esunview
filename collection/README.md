In the `collection` root folder are subfolders that become the names of collections.

Lipupini will attempt to serve any supported non-hidden files in these directories. If you drop a new video file into a collection folder, Lipupini will show it in the collection if it knows how to read the filetype. (See [MediaProcessors](../module/Lipupini/Collection/MediaProcessor/))

Within an identifier folder is a `.lipupini` folder. This folder should have all the necessary data to configure an entire account just by dropping it into the filesystem.

Within the `.lipupini` folder is a JSON file `files.json` containing information about each file and the order in which they should be displayed. If a filename matches an entry, the data from that entry will be used when loading the file.

For example, the JSON might look like this:

```json
{
	"cat-scarf.jpg": {
		"caption": "Scarf Cat"
	},
	"dup.mp4": {
		"thumbnail": "logo3d.jpg"
	},
	"cat-hat.jpg": {
		"caption": "Hat Cat"
	},
	"Memes": {
		"caption": "Memes Folder"
	}
}
```

Individual files can be `hidden` or `unlisted` via a `visibility` option. Files marked as `hidden` do not show on the web. `unlisted` files show in detail view and do not show in grid view. Using the example above to hide and unlist the first two files respectively:

```json
{
	"cat-scarf.jpg": {
		"caption": "Scarf Cat",
		"visibility": "hidden"
	},
	"dup.mp4": {
		"thumbnail": "logo3d.jpg",
		"visibility": "unlisted"
	},
	"cat-hat.jpg": {
		"caption": "Hat Cat"
	},
	"Memes": {
		"caption": "Memes Folder"
	}
}
```

Thumbnails are autogenerated by default for images. To use a custom thumbnail, put it in a `.lipupini/image/thumbnail` folder with the same name as the original image.

For manual video thumbnails when not autogenerated with `ffmpeg`, append a `.jpg` to the filename, e.g. `myvideo.mp4.jpg`, and put them in `.lipupini/video/thumbnail`. Audio cover art thumbnails go into `.lipupini/audio/thumbnail`, and if you're not using `ffmpeg` you can add generated audio waveform images to `.lipupini/audio/waveform`.

If you have [ffmpeg](https://ffmpeg.org//) installed, you can try enabling the `useFfmpeg` option in `system/config/state.php` and Lipupini will use it to grab the center frame for automatic video thumbnails, and automatic audio waveforms.

The root `.lipupini` folder also contains public and private RSA keys for the collection to make signed requests e.g. for ActivityPub. These can be generated using the CLI command `bin/collection/generate-keys.php COLLECTION_NAME`.

## Vision

Linux user folders bound into `collection`, for example:

```shell
bob@domain $ pwd
/home/bob/Lipupini

bob@domain $ ls -A
cat-hat.png  cat-scarf.jpg  dup.mp4  .lipupini  memes  poetry  winamp-intro.mp3

webserver@domain $ su - webserver

webserver@domain $ pwd
/var/www/lipupini

# Create the mount
webserver@domain $ sudo mount --bind /home/bob/collection /var/www/lipupini/collection/bob

# Update `fstab` to make the mount persist restarts, add this line:
# /home/bob/collection   /var/www/lipupini/collection   none   bind   0 0

webserver@domain $ ls -A collection/bob
cat-hat.png  cat-scarf.jpg  dup.mp4  .lipupini  memes  poetry  winamp-intro.mp3
```
After symlinking, user `bob` can log in using SFTP and see a `Lipupini` directory in their `/home/bob` directory. The files placed in this directory are then automatically served by Lipupini. The collection is also searchable in the Fediverse and can be subscribed via RSS.

Now "Bob" can log in and upload or sync files using many standard methods for which tons of great tutorials are already written. The organization of the files stays the same as it is on Bob's local computer. "Bob" can use [WinSCP](https://winscp.net), [FileZilla](https://filezilla-project.org), [MacOS file manager](https://support.apple.com/guide/mac-help/connect-mac-shared-computers-servers-mchlp1140/mac), [Linux file manager](https://help.ubuntu.com/stable/ubuntu-help/nautilus-connect.html.en), other desktop and mobile file managers, remote drive mount, [Git repository](https://git-scm.com/docs/git-remote), [rsync](https://rsync.samba.org), [rclone](https://rclone.org), [Unison](https://www.cis.upenn.edu/~bcpierce/unison/), [FreeFileSync](https://freefilesync.org), [Warpinator](https://github.com/linuxmint/warpinator), [Magic Wormhole](https://github.com/magic-wormhole/magic-wormhole), [Syncthing](https://syncthing.net), [inotify](https://en.wikipedia.org/wiki/Inotify), etc etc.

Additionally, native applications can be created to add files and update the JSON for collections. This method also does not place any limitation on what can be achieved later via the website.
